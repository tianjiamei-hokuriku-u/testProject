<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Todo List</title>

  <!-- Bootstrap CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
  <div class="container py-4">

    <!-- Header -->
    <div class="d-flex align-items-center justify-content-between mb-3">
      <div>
        <h1 class="h3 mb-1">Todo List</h1>
        <div class="text-muted small">Manage your daily tasks</div>
      </div>
      <a class="btn btn-primary" href="{% url 'todo_create' %}">
        + New Todo
      </a>
    </div>

    <!-- Filter -->
    <div class="btn-group mb-3" role="group">
      <a class="btn btn-outline-secondary {% if status == 'all' %}active{% endif %}"
        href="{% url 'todo_list' %}?status=all">
        All
      </a>

      <a class="btn btn-outline-secondary {% if status == 'active' %}active{% endif %}"
        href="{% url 'todo_list' %}?status=active">
        Active
      </a>

      <a class="btn btn-outline-secondary {% if status == 'done' %}active{% endif %}"
        href="{% url 'todo_list' %}?status=done">
        Done
      </a>
    </div>


    <!-- Stats -->
    <div class="row g-2 mb-3">
      <div class="col-12 col-md-4">
        <div class="card">
          <div class="card-body">
            <div class="text-muted small">Total</div>
            <div class="fs-4 fw-semibold">{{ total }}</div>
          </div>
        </div>
      </div>

      <div class="col-12 col-md-4">
        <div class="card">
          <div class="card-body">
            <div class="text-muted small">Active</div>
            <div class="fs-4 fw-semibold">{{ active_count }}</div>
          </div>
        </div>
      </div>

      <div class="col-12 col-md-4">
        <div class="card">
          <div class="card-body">
            <div class="text-muted small">Done</div>
            <div class="fs-4 fw-semibold">{{ done_count }}</div>
          </div>
        </div>
      </div>
    </div>


    <!-- List -->
    <div class="card shadow-sm">
      <div class="card-header bg-white">
        <div class="fw-semibold">Tasks</div>
      </div>

      <div class="card-body p-0">
        {% if todos %}
          <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
              <thead class="table-light">
                <tr>
                  <th style="width: 7rem;">Status</th>
                  <th>Title</th>
                  <th style="width: 8rem;">Priority</th>
                  <th style="width: 10rem;">Due</th>
                  <th style="width: 12rem;" class="text-end">Actions</th>
                </tr>
              </thead>

              <tbody>
                {% for t in todos %}
                  <tr>
                    <!-- Status -->
                    <td>
                      {% if t.is_done %}
                        <span class="badge text-bg-success">DONE</span>
                      {% else %}
                        <span class="badge text-bg-secondary">TODO</span>
                      {% endif %}
                    </td>

                    <!-- Title + Description -->
                    <td>
                      <div class="fw-semibold">
                        {% if t.is_done %}
                          <span class="text-decoration-line-through text-muted">{{ t.title }}</span>
                        {% else %}
                          {{ t.title }}
                        {% endif %}
                      </div>
                      {% if t.description %}
                        <div class="text-muted small">{{ t.description }}</div>
                      {% endif %}
                    </td>

                    <!-- Priority -->
                    <td>
                      {% if t.priority == "HIGH" %}
                        <span class="badge text-bg-danger">HIGH</span>
                      {% elif t.priority == "MEDIUM" %}
                        <span class="badge text-bg-warning">MEDIUM</span>
                      {% else %}
                        <span class="badge text-bg-info">LOW</span>
                      {% endif %}
                    </td>

                    <!-- Due -->
                    <td>
                      {% if t.due_date %}
                        {{ t.due_date }}
                      {% else %}
                        <span class="text-muted">No due</span>
                      {% endif %}
                    </td>

                    <!-- Actions -->
                    <td class="text-end">
                      <a class="btn btn-sm btn-outline-primary"
                         href="{% url 'todo_toggle' t.id %}">
                        {% if t.is_done %}Undo{% else %}Done{% endif %}
                      </a>

                      <a class="btn btn-sm btn-outline-danger"
                         href="{% url 'todo_delete' t.id %}">
                        Delete
                      </a>

                      <a class="btn btn-sm btn-outline-secondary" 
                        href="{% url 'todo_edit' t.id %}">
                        Edit</a>


                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <div class="p-4 text-center">
            <div class="text-muted mb-2">No tasks yet.</div>
            <a class="btn btn-primary" href="{% url 'todo_create' %}">Create your first task</a>
          </div>
        {% endif %}
      </div>
    </div>

    <div class="text-muted small mt-3">
      Tip: Click "Done/Undo" to toggle status. Use "Delete" to remove a task.
    </div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
